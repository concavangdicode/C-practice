<!DOCTYPE html>
<html><head></head><body style="color: rgb(32, 33, 34); font-family: undefined;"><h1 id="comp-2160-assignment-2" style="font-family: Helvetica, Arial, sans-serif; font-size: x-large; font-weight: bold; text-align: center; width: 100%; padding: 12px; background-color: #ffa080; color: #000080; margin: 0; border-bottom: thin solid;" align="center" width="100%" bgcolor="#FFA080">COMP 2160 Assignment 2</h1>
<h2 id="material-covered" style="font-family: Helvetica, Arial, sans-serif; font-size: large; font-weight: bold; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #000080;">Material covered:</h2>
<ul>
<li>basic C: syntax, types, and functions</li>
<li>more advanced C: arrays, strings, structs, and I/O</li>
<li>simple data structures and algorithms in C</li>
<li>contracts</li>
</ul>
<h2 id="notes" style="font-family: Helvetica, Arial, sans-serif; font-size: large; font-weight: bold; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #000080;">Notes:</h2>
<ul>
<li>You must follow the programming standards and best practices not doing so will result in a loss of marks. For this assignment, respect <strong>all</strong> standards and practices.</li>
<li>All the C code you write for the question must be in a single source file: submit one <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">.c</code> file containing your work, and optionally the given&nbsp;<code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: rgb(255, 255, 232);" bgcolor="#FFFFE8">a2_tests.c</code>&nbsp;file.</li>
<li>You must accept and follow all of the academic integrity requirements for the course, including the Expectations for Individual Work in Computer Science.</li>
<li>You must fill in an honesty declaration <strong>for this assignment before</strong> you submit your solution.</li>
<li>Your assignment code must be handed in electronically on the CS Linux system (aviary) as the assignment <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">fall2023-a2</code>; see the <a>hand-in guidelines</a> for details. No other assignment submission method will be accepted.</li>
<li>The C code you submit must compile and run on that system without warnings or errors.</li>
</ul>
<h2 id="question-1-contacts" style="font-family: Helvetica, Arial, sans-serif; font-size: large; font-weight: bold; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #000080;">Question 1: Contacts</h2>
<p style="text-align: center; font-style: italic;">This question is worth 100% of the assignment mark.</p>
<p>Write a complete C program that will manage a list of contacts for a user. These are the names and phone numbers of people or companies that the user knows or regularly needs to contact.</p>
<p>The information in the list will be stored using <strong>two</strong> arrays of structs:</p>
<ul>
<li>The <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">Contacts</code> struct optionally contain an integer <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">id</code> and must contain the <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">name</code> of the person or company (a single string), and the <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">relationship</code> to the user (another string).</li>
<li>A <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">PhoneNumber</code> struct contain the <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">id</code> of the contact that the phone number belongs to, a string <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">type</code> (containing something like "home", "mobile", etc.), an integer area <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">code</code>, and an integer phone <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">number</code>.</li>
</ul>
<p>When you first run the program, it will open a file named <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">contacts.txt</code> in the same folder as your C program. It will read contacts from this file in the format described below and store it in the list of contacts. It will print the list of contacts, and then it will accept commands from the user typed into the console.</p>
<p>The input file <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">contacts.txt</code> is formatted as follows:</p>
<ul>
<li>Each contact begins with the contact's name on a line. This is <strong>optionally</strong> followed by a single comma, and the relationship.</li>
<li>This is followed by some number of lines containing phone numbers, formatted as follows: <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">AAA NNNNNNN type</code> where <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">AAA</code> is a 3-digit area code, <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">NNNNNNN</code> is a 7-digit phone number, and <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">type</code> is the phone number type string, which continues until the end of the line.</li>
<li>If there are more contacts in the file, this is followed by a blank line, containing <em>no</em> other characters.</li>
<li>This repeats until end of file.</li>
</ul>
<p>Here is an example of a <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">contacts.txt</code>:</p>
<pre style="background-color: #ffffd0; border-top: dotted thin black; border-bottom: dotted thin black; margin-right: 20px; margin-left: 20px; padding: 1em 0.5em 1em 0.5em;" bgcolor="#FFFFD0"><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: transparent; white-space: pre-wrap;">The Shoe Shoppe,employer
555 7782922 company

Mahfuz Miyazaki,partner
431 5551234 mobile

Mom
204 5558432 mobile
204 5559898 work
431 5554321 land line</code></pre>
<p>Once you have read the input file, print the details of all the contacts, <strong>ordered alphabetically by name</strong>, numbered starting from 1, and the phone numbers, <strong>ordered alphabetically by type</strong>. The contact's relationship, if present, follows the name and is in parentheses. The phone numbers are indented underneath each contact. The output from printing the contacts above would look similar to this:</p>
<pre style="background-color: #ffffd0; border-top: dotted thin black; border-bottom: dotted thin black; margin-right: 20px; margin-left: 20px; padding: 1em 0.5em 1em 0.5em;" bgcolor="#FFFFD0"><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: transparent; white-space: pre-wrap;"> 1. Mahfuz Miyazaki (partner)
    mobile (431) 5551234
 2. Mom
    land line (431) 5554321
    mobile (204) 5558432
    work (204) 5559898
 3. The Shoe Shoppe (employer)
    company (555) 7782922</code></pre>
<p>After the initial output, your program will prompt the user and read commands they type. Command names are entered on a line by themselves. There are seven commands:</p>
<ul>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">new</code> will add a new contact to the list. On the next line, the user will enter the name, and optionally a comma followed by a relationship. The name cannot be empty, and cannot be identical to the name of an existing contact.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">delete</code> will delete a contact from the list. It will print the short form of the contacts. Then the user will enter a number indicating the position of the user in the printed list. For example, <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">2</code> would delete Mom. Note that the phone numbers belonging to the contact would also be deleted, or at least not printed or saved anywhere.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">add</code> will add a phone number to a contact. It will print the short form of the contacts. Then the user will enter a number indicating the position of the contact in the printed list; if this is valid, they will enter a complete phone number as described above. For example: <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">add</code> followed by <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">3</code> and then <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">204 5551234 mobile</code> will add a mobile number to the contact <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">The Shoe Shoppe</code>.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">remove</code> will remove a phone number from a contact. It will print the short list of contacts. Then the user will enter a number indicating the position of the contact in the printed list; if this is valid, they will enter a type. It will remove the phone number with a matching type from that contact. For example: <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">remove</code> followed by <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">2</code> and then <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">work</code> will remove Mom's work number.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">print</code> will print the contacts and phone numbers in the format described above.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">save</code> will ask the user for a filename and save the contacts to that file with the same file format described above. The order doesn't matter.</li>
<li><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">quit</code> will quit the program.</li>
</ul>
<p>The "short form" of the contacts list will print them without the phone numbers; for example:</p>
<pre style="background-color: #ffffd0; border-top: dotted thin black; border-bottom: dotted thin black; margin-right: 20px; margin-left: 20px; padding: 1em 0.5em 1em 0.5em;" bgcolor="#FFFFD0"><code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: transparent; white-space: pre-wrap;"> 1. Mahfuz Miyazaki (partner)
 2. Mom
 3. The Shoe Shoppe (employer)</code></pre>
<p>Errors can occur reading from the input file; your program should recover from these as gracefully as possible by printing error messages and ignoring invalid data whenever it can. Errors in the interactive input should cause the rest of the command to be ignored and return to the prompt. No input from the file or console should cause the program to crash.</p>
<h3 id="interface" style="font-size: medium; font-variant: small-caps; text-decoration: underline; color: #000080;">Interface</h3>
<p>Implement the following functions in your code.</p>
<div class="sourceCode" id="cb4" style="overflow: visible; margin: 1em 0;">
<pre class="sourceCode c" style="background-color: #ffffd8; border-top: dotted thin black; border-bottom: dotted thin black; margin-right: 20px; margin-left: 20px; overflow: visible; margin: 0; padding: 1em 0.5em 1em 0.5em;" bgcolor="#FFFFD8"><code class="sourceCode c" style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: transparent; white-space: pre; overflow: visible; position: relative;"><span id="cb4-1" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co" style="color: #60a0b0; font-style: italic;">// requires: typedef enum { FALSE=0, TRUE=1 } Boolean;</span></span>
<span id="cb4-2" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dt" style="color: #902000;">int</span> new_contact<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">char</span> name<span class="op" style="color: #666;">[],</span> <span class="dt" style="color: #902000;">char</span> relationship<span class="op" style="color: #666;">[]);</span> <span class="co" style="color: #60a0b0; font-style: italic;">// name is mandatory and unique, relationship may be empty</span></span>
<span id="cb4-4" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Boolean delete_contact<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">int</span> contact<span class="op" style="color: #666;">);</span> <span class="co" style="color: #60a0b0; font-style: italic;">// contact ID as returned from new_contact</span></span>
<span id="cb4-5" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Boolean add_phone<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">int</span> contact<span class="op" style="color: #666;">,</span> <span class="dt" style="color: #902000;">int</span> area<span class="op" style="color: #666;">,</span> <span class="dt" style="color: #902000;">int</span> number<span class="op" style="color: #666;">,</span> <span class="dt" style="color: #902000;">char</span> type<span class="op" style="color: #666;">[]);</span> <span class="co" style="color: #60a0b0; font-style: italic;">// area and number must be valid</span></span>
<span id="cb4-6" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Boolean remove_phone<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">int</span> contact<span class="op" style="color: #666;">,</span> <span class="dt" style="color: #902000;">char</span> type<span class="op" style="color: #666;">[]);</span> <span class="co" style="color: #60a0b0; font-style: italic;">// phone of that type must exist</span></span>
<span id="cb4-7" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dt" style="color: #902000;">void</span> print_contacts<span class="op" style="color: #666;">(</span>Boolean with_phone<span class="op" style="color: #666;">);</span></span>
<span id="cb4-8" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Boolean save_contacts<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">char</span> filename<span class="op" style="color: #666;">[]);</span></span>
<span id="cb4-9" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="dt" style="color: #902000;">int</span> count_contacts<span class="op" style="color: #666;">();</span></span>
<span id="cb4-11" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="dt" style="color: #902000;">int</span> count_contact_numbers<span class="op" style="color: #666;">(</span><span class="dt" style="color: #902000;">int</span> id<span class="op" style="color: #666;">);</span></span>
<span id="cb4-12" style="{color: inherit; text-decoration: inherit; display: inline-block; line-height: 1.25} :empty{height:1.2em};"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="dt" style="color: #902000;">int</span> count_all_numbers<span class="op" style="color: #666;">();</span></span></code></pre>
</div>
<p>The first group of functions can be used both by user commands, and to add new information as it is read from the input file. The first function returns the contact's id (however you implement that), and is passed to the subsequent function as the <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">contact</code> parameter. A result of -1 will indicate an error. The functions with <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">Boolean</code> results return <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">TRUE</code> if the function was successful or <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">FALSE</code> in the event of an error. Examples of errors include deleting a non-existing or negative contact ID, adding an invalid phone number, removing a non-existent phone type, or trying to add or remove phone numbers from an invalid contact.</p>
<p>The last three functions count the contacts, the phone numbers belonging to a contact, and the total count of phone numbers for all contacts. The second function should return -1 on error (invalid or not found contact).</p>
<p>Most of these functions can be tested by replacing your main program with the code from <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">test_contacts.c</code> found on UMLearn. Your program must pass all of these tests.</p>
<h3 id="programming-practices" style="font-size: medium; font-variant: small-caps; text-decoration: underline; color: #000080;">Programming practices:</h3>
<p>Write <strong>contracts</strong> to ensure that your functions communicate properly. In particular, the first group of functions from the interface above <strong>must</strong> use appropriate assertions.</p>
<p>For this question, you do <strong>not need to write any tests of your own</strong>, but you must <strong>pass the given tests</strong>.</p>
<p>Your program <strong>must be separated into functions</strong> for performing major tasks. Beyond the interface above, ensure that your program is well-organized and does not gratuitously duplicate code.</p>
<p>The focus for this question is on <strong>error handling</strong>, as part of the interface functions, and when working with files and handling input from the user.</p>
<p>Your complete program must not crash or produce invalid results <strong>under any circumstances</strong> (except maybe cosmic rays, but don't try to blame those).</p>
<h3 id="notes-1" style="font-size: medium; font-variant: small-caps; text-decoration: underline; color: #000080;">Notes:</h3>
<ul>
<li>There is <strong>no dynamic memory allocation</strong> in this assignment (no <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">malloc</code>). You can assume the following maximums:
<ul>
<li>At most 100 contacts.</li>
<li>At most 500 phone numbers total.</li>
<li>At most 51 characters for a name (counting \0).</li>
<li>At most 21 characters for a relationship or phone number type (counting \0).</li>
</ul>
Consider the maximums when you are adding data. If a string (name, relationship, or type) is too long, or if the maximum number of contacts or phone numbers has already been reached, it is an error: do <strong>not</strong> add the contact or phone number.</li>
<li>For this assignment (only), use <strong>global</strong> <span style="color: rgb(207, 42, 39);"><s>arrays for contacts and phone numbers</s></span> variables for the data structure, including the arrays, their partially-filled sizes, and (optionally) an ID value that is incremented with each new contact.</li>
<li>If you choose to give each contact an <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">id</code>, you can construct it however you like; for example, count from 1 and increase with each new contact. A valid contact ID must always be greater than or equal to zero. It won't be stored in the input or output text files.</li>
<li>A contact can have more than one phone number of the same type. If you remove that type, remove all that match.</li>
<li>When the user enters commands or data for a command, your program must display an appropriate prompt for input.</li>
<li>When error handling, you can assume that an area code must be &gt;= 100 and a phone number must be &gt;= 1000000; neither of these bottom ranges are valid but we don't need to validate them further.</li>
<li>You can either implement your own sort, or use ordered insertion, or use <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">qsort()</code> from <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">stdlib.h</code>. See the sample program <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">qsort_demo.c</code> for an example of using it to sort structs.</li>
<li>The name of the input file is passed as the one and only <strong>command-line argument</strong>. If no argument is passed, start with an empty list of contacts. See <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">cla.c</code> for an example.</li>
<li>The tests you must pass are given in <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">a2_tests.c</code> which includes an alternate main program. It can be compiled using instructions at the top of the file <em>or</em> you can copy the code into your program for testing, but <strong>remove all of it</strong> before handing it in.</li>
<li>You can download a sample <code style="font-family: Consolas, Courier, 'Courier New', monospace; background-color: #ffffe8; white-space: pre-wrap;" bgcolor="#FFFFE8">contacts.txt</code> from UMLearn. The markers may use a different input file (or more than one) but it will be formatted exactly as described above.</li>
</ul></body></html>